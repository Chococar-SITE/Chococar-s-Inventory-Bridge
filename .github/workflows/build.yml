name: Build Multi-Version JAR Files

on:
  push:
    branches: [ main, develop ]
    tags: [ 'v*' ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:
    inputs:
      release_type:
        description: 'Release type'
        required: false
        default: 'snapshot'
        type: choice
        options:
        - snapshot
        - release

jobs:
  get-versions:
    runs-on: ubuntu-latest
    outputs:
      versions: ${{ steps.versions.outputs.versions }}
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    - name: Get supported versions
      id: versions
      run: |
        python << 'EOF'
        import json
        import os
        
        with open('data/latest_versions.json', 'r') as f:
            versions_data = json.load(f)
        
        complete_versions = [v for v, data in versions_data.items() if data['status'] == 'complete']
        complete_versions.sort(key=lambda x: [int(i) for i in x.split('.')], reverse=True)
        
        print(f"æ”¯æ´çš„ç‰ˆæœ¬: {', '.join(complete_versions)}")
        
        github_output = os.environ.get('GITHUB_OUTPUT')
        if github_output:
            with open(github_output, 'a') as f:
                f.write(f'versions={json.dumps(complete_versions)}\n')
        EOF

  test-units:
    needs: get-versions
    runs-on: ubuntu-latest
    
    name: Run Unit Tests
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Validate Gradle wrapper
      uses: gradle/actions/wrapper-validation@v4
      
    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        
    - name: Setup Gradle
      uses: gradle/actions/setup-gradle@v4
      with:
        cache-cleanup: on-success
        
    - name: Make gradlew executable
      run: chmod +x ./gradlew
      
    - name: Cache Gradle packages
      uses: actions/cache@v4
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-test-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
        restore-keys: |
          ${{ runner.os }}-gradle-test-
          ${{ runner.os }}-gradle-
          
    - name: Run Common module tests
      run: |
        echo "ğŸ§ª é‹è¡Œ Common æ¨¡çµ„å–®å…ƒæ¸¬è©¦..."
        ./gradlew :common:test --no-daemon --continue
        
    - name: Run Paper module tests
      run: |
        echo "ğŸ§ª é‹è¡Œ Paper æ¨¡çµ„å–®å…ƒæ¸¬è©¦..."
        ./gradlew :paper:test --no-daemon --continue
        
    - name: Run Fabric module tests
      run: |
        echo "ğŸ§ª é‹è¡Œ Fabric æ¨¡çµ„å–®å…ƒæ¸¬è©¦..."
        # æ³¨æ„ï¼šFabric æ¸¬è©¦ç”±æ–¼ Minecraft ç’°å¢ƒä¾è³´ï¼Œåƒ…é‹è¡Œç·¨è­¯æª¢æŸ¥
        ./gradlew :fabric:compileTestJava --no-daemon
        echo "âœ… Fabric æ¸¬è©¦ç·¨è­¯æˆåŠŸï¼ˆè·³éé‹è¡Œéšæ®µï¼Œå›  Minecraft ç’°å¢ƒä¾è³´ï¼‰"
        
    - name: Generate test reports
      if: always()
      run: |
        echo "ğŸ“Š ç”Ÿæˆæ¸¬è©¦å ±å‘Šæ‘˜è¦..."
        
        # æª¢æŸ¥å„æ¨¡çµ„æ¸¬è©¦çµæœ
        if [ -d "common/build/test-results/test" ]; then
          echo "ğŸ“‹ Common æ¨¡çµ„æ¸¬è©¦çµæœï¼š"
          find common/build/test-results/test -name "*.xml" -exec grep -l "failures=\"0\" errors=\"0\"" {} \; | wc -l | xargs echo "  âœ… é€šéçš„æ¸¬è©¦å¥—ä»¶ï¼š"
          find common/build/test-results/test -name "*.xml" -exec grep -L "failures=\"0\" errors=\"0\"" {} \; | wc -l | xargs echo "  âŒ å¤±æ•—çš„æ¸¬è©¦å¥—ä»¶ï¼š"
        fi
        
        if [ -d "paper/build/test-results/test" ]; then
          echo "ğŸ“‹ Paper æ¨¡çµ„æ¸¬è©¦çµæœï¼š"
          find paper/build/test-results/test -name "*.xml" -exec grep -l "failures=\"0\" errors=\"0\"" {} \; | wc -l | xargs echo "  âœ… é€šéçš„æ¸¬è©¦å¥—ä»¶ï¼š"
          find paper/build/test-results/test -name "*.xml" -exec grep -L "failures=\"0\" errors=\"0\"" {} \; | wc -l | xargs echo "  âŒ å¤±æ•—çš„æ¸¬è©¦å¥—ä»¶ï¼š"
        fi
        
        echo "ğŸ“‹ Fabric æ¨¡çµ„ï¼š"
        echo "  âœ… ç·¨è­¯æª¢æŸ¥é€šé"
        echo "  âš ï¸ é‹è¡Œæ¸¬è©¦è·³éï¼ˆéœ€è¦ Minecraft ç’°å¢ƒï¼‰"
        
    - name: Upload test results
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: test-results
        path: |
          **/build/test-results/test/**/*.xml
          **/build/reports/tests/test/**/*
        retention-days: 7
        
    - name: Publish test results
      uses: dorny/test-reporter@v1
      if: always()
      with:
        name: Unit Test Results
        path: '**/build/test-results/test/**/*.xml'
        reporter: java-junit
        fail-on-error: false
        
    - name: Test summary
      if: always()
      run: |
        echo "## ğŸ§ª å–®å…ƒæ¸¬è©¦æ‘˜è¦" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "| æ¨¡çµ„ | ç‹€æ…‹ | å‚™è¨» |" >> $GITHUB_STEP_SUMMARY
        echo "|------|------|------|" >> $GITHUB_STEP_SUMMARY
        
        # Common æ¨¡çµ„
        if [ -d "common/build/test-results/test" ]; then
          COMMON_TESTS=$(find common/build/test-results/test -name "*.xml" | wc -l)
          COMMON_PASSED=$(find common/build/test-results/test -name "*.xml" -exec grep -l "failures=\"0\" errors=\"0\"" {} \; 2>/dev/null | wc -l)
          echo "| Common | âœ… é€šé | $COMMON_PASSED/$COMMON_TESTS æ¸¬è©¦å¥—ä»¶é€šé |" >> $GITHUB_STEP_SUMMARY
        else
          echo "| Common | âŒ å¤±æ•— | æ¸¬è©¦çµæœæª”æ¡ˆæœªæ‰¾åˆ° |" >> $GITHUB_STEP_SUMMARY
        fi
        
        # Paper æ¨¡çµ„
        if [ -d "paper/build/test-results/test" ]; then
          PAPER_TESTS=$(find paper/build/test-results/test -name "*.xml" | wc -l)
          PAPER_PASSED=$(find paper/build/test-results/test -name "*.xml" -exec grep -l "failures=\"0\" errors=\"0\"" {} \; 2>/dev/null | wc -l)
          echo "| Paper | âœ… é€šé | $PAPER_PASSED/$PAPER_TESTS æ¸¬è©¦å¥—ä»¶é€šé |" >> $GITHUB_STEP_SUMMARY
        else
          echo "| Paper | âŒ å¤±æ•— | æ¸¬è©¦çµæœæª”æ¡ˆæœªæ‰¾åˆ° |" >> $GITHUB_STEP_SUMMARY
        fi
        
        # Fabric æ¨¡çµ„
        echo "| Fabric | âš ï¸ éƒ¨åˆ† | ç·¨è­¯æª¢æŸ¥é€šéï¼Œé‹è¡Œæ¸¬è©¦éœ€ Minecraft ç’°å¢ƒ |" >> $GITHUB_STEP_SUMMARY
        
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "ğŸ“‹ **è©³ç´°æ¸¬è©¦å ±å‘Š**: è«‹æŸ¥çœ‹ Actions é é¢çš„ 'Unit Test Results' å ±å‘Š" >> $GITHUB_STEP_SUMMARY

  build-matrix:
    needs: [get-versions, test-units]
    runs-on: ubuntu-latest
    strategy:
      matrix:
        platform:
          - fabric
          - paper
        mc_version: ${{ fromJson(needs.get-versions.outputs.versions) }}
    
    name: Build ${{ matrix.platform }} for MC ${{ matrix.mc_version }}
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Validate Gradle wrapper
      uses: gradle/actions/wrapper-validation@v4
      
    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        
    - name: Setup Gradle
      uses: gradle/actions/setup-gradle@v4
      with:
        cache-cleanup: on-success
        
    - name: Make gradlew executable
      run: chmod +x ./gradlew
      
    - name: Load version data for MC ${{ matrix.mc_version }}
      run: |
        echo "ğŸ“‹ è®€å– MC ${{ matrix.mc_version }} ç‰ˆæœ¬æ•¸æ“š..."
        
        # è®€å–ä¸¦è§£æç‰ˆæœ¬æ•¸æ“š
        python << 'EOF'
        import json
        import os
        
        mc_version = "${{ matrix.mc_version }}"
        
        with open('data/latest_versions.json', 'r') as f:
            versions_data = json.load(f)
        
        if mc_version not in versions_data:
            print(f"âŒ ç‰ˆæœ¬ {mc_version} ä¸å­˜åœ¨æ–¼æ•¸æ“šä¸­")
            exit(1)
        
        data = versions_data[mc_version]
        
        if data['status'] != 'complete':
            print(f"âŒ ç‰ˆæœ¬ {mc_version} ç‹€æ…‹ä¸å®Œæ•´: {data['status']}")
            exit(1)
        
        print(f"ğŸ”§ æ§‹å»º {mc_version}...")
        
        # è¨­å®šåŸºæœ¬ç‰ˆæœ¬è™Ÿ
        if "${{ github.ref }}".startswith("refs/tags/"):
            version = "${{ github.ref }}".split("/")[-1].replace("v", "")
        else:
            version = f"1.0.0-SNAPSHOT+mc{mc_version}"
        
        artifact_name = f"chococars-inventory-bridge-${{ matrix.platform }}-{mc_version}-{version}"
        
        print(f"æ§‹å»ºé…ç½®:")
        print(f"  Minecraft: {mc_version}")
        print(f"  Yarn: {data['yarn_mappings']}")
        print(f"  Fabric API: {data['fabric_api']}")
        print(f"  Paper: {data['paper']}")
        print(f"  Data Version: {data['data_version']}")
        print(f"  Artifact: {artifact_name}")
        
        # è¨­ç½®ç’°å¢ƒè®Šé‡
        with open(os.environ['GITHUB_ENV'], 'a') as env_file:
            env_file.write(f"MC_VERSION={mc_version}\n")
            env_file.write(f"YARN_VERSION={data['yarn_mappings']}\n")
            env_file.write(f"FABRIC_API_VERSION={data['fabric_api']}\n")
            env_file.write(f"PAPER_VERSION={data['paper']}\n")
            env_file.write(f"DATA_VERSION={data['data_version']}\n")
            env_file.write(f"VERSION={version}\n")
            env_file.write(f"ARTIFACT_NAME={artifact_name}\n")
        EOF
        
    - name: Update version configurations
      run: |
        # æ›´æ–° gradle.properties
        cat > gradle.properties << EOF
        org.gradle.jvmargs=-Xmx4G
        minecraft_version=$MC_VERSION
        yarn_mappings=$YARN_VERSION
        loader_version=0.16.9
        mod_version=$VERSION
        maven_group=site.chococar
        archives_base_name=chococars-inventory-bridge
        fabric_version=$FABRIC_API_VERSION
        paper_version=$PAPER_VERSION
        data_version=$DATA_VERSION
        EOF
        
        # æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„ç‰ˆæœ¬
        find . -name "*.yml" -type f -exec sed -i "s/minecraftVersion: \"1.21.8\"/minecraftVersion: \"$MC_VERSION\"/g" {} \;
        
    - name: Cache Gradle packages
      uses: actions/cache@v4
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-${{ matrix.mc_version }}-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
        restore-keys: |
          ${{ runner.os }}-gradle-${{ matrix.mc_version }}-
          ${{ runner.os }}-gradle-
          
    - name: Build common module
      run: ./gradlew :common:build --no-daemon
      
    - name: Build Fabric mod
      if: matrix.platform == 'fabric'
      run: |
        # æ›´æ–° Fabric ç‰¹å®šç‰ˆæœ¬
        sed -i "s/minecraft \"com.mojang:minecraft:.*\"/minecraft \"com.mojang:minecraft:$MC_VERSION\"/g" fabric/build.gradle
        sed -i "s/mappings \"net.fabricmc:yarn:.*\"/mappings \"net.fabricmc:yarn:$YARN_VERSION:v2\"/g" fabric/build.gradle
        sed -i "s/modImplementation \"net.fabricmc.fabric-api:fabric-api:.*\"/modImplementation \"net.fabricmc.fabric-api:fabric-api:$FABRIC_API_VERSION\"/g" fabric/build.gradle
        
        ./gradlew :fabric:build --no-daemon
        
    - name: Build Paper plugin
      if: matrix.platform == 'paper'
      run: |
        # æ›´æ–° Paper ç‰¹å®šç‰ˆæœ¬
        sed -i "s/paperweight.paperDevBundle(\".*\")/paperweight.paperDevBundle(\"$PAPER_VERSION\")/g" paper/build.gradle
        
        ./gradlew :paper:build --no-daemon
        
    - name: Rename artifacts
      run: |
        if [ "${{ matrix.platform }}" == "fabric" ]; then
          BUILD_DIR="fabric/build/libs"
          ORIGINAL_JAR=$(find $BUILD_DIR -name "*.jar" ! -name "*-dev.jar" ! -name "*-sources.jar" | head -n 1)
        else
          BUILD_DIR="paper/build/libs"
          ORIGINAL_JAR=$(find $BUILD_DIR -name "*.jar" ! -name "*-dev.jar" ! -name "*-sources.jar" | head -n 1)
        fi
        
        if [ -f "$ORIGINAL_JAR" ]; then
          mv "$ORIGINAL_JAR" "$BUILD_DIR/$ARTIFACT_NAME.jar"
          echo "Renamed to: $ARTIFACT_NAME.jar"
        fi
        
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: ${{ env.ARTIFACT_NAME }}
        path: |
          ${{ matrix.platform }}/build/libs/${{ env.ARTIFACT_NAME }}.jar
        retention-days: 30
        
    - name: Test JAR file
      run: |
        BUILD_DIR="${{ matrix.platform }}/build/libs"
        JAR_FILE="$BUILD_DIR/$ARTIFACT_NAME.jar"
        
        if [ -f "$JAR_FILE" ]; then
          echo "âœ… JAR file created successfully: $JAR_FILE"
          echo "ğŸ“¦ File size: $(du -h "$JAR_FILE" | cut -f1)"
          
          # æª¢æŸ¥ JAR å…§å®¹
          if [ "${{ matrix.platform }}" == "fabric" ]; then
            echo "ğŸ” Checking Fabric mod.json..."
            unzip -l "$JAR_FILE" | grep -E "(fabric.mod.json|mixins.json)" || echo "âš ï¸ Missing Fabric metadata"
          else
            echo "ğŸ” Checking Paper plugin.yml..."
            unzip -l "$JAR_FILE" | grep "paper-plugin.yml" || echo "âš ï¸ Missing Paper plugin.yml"
          fi
        else
          echo "âŒ JAR file not found: $JAR_FILE"
          exit 1
        fi

  test-fabric-server:
    needs: [get-versions, test-units, build-matrix]
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Get latest version and set up environment
      run: |
        echo "ğŸ“‹ ç²å–æœ€æ–°ç‰ˆæœ¬é€²è¡Œæ¸¬è©¦..."
        python << 'EOF'
        import json
        import os
        
        with open('data/latest_versions.json', 'r') as f:
            versions_data = json.load(f)
        
        complete_versions = [v for v, data in versions_data.items() if data['status'] == 'complete']
        complete_versions.sort(key=lambda x: [int(i) for i in x.split('.')], reverse=True)
        
        if not complete_versions:
            print("âŒ æ²’æœ‰æ‰¾åˆ°å®Œæ•´çš„ç‰ˆæœ¬")
            exit(1)
            
        latest_version = complete_versions[0]
        data = versions_data[latest_version]
        
        print(f"ğŸ¯ é¸æ“‡æœ€æ–°ç‰ˆæœ¬é€²è¡Œæ¸¬è©¦: {latest_version}")
        
        # ç²å–æœ€æ–°çš„ Fabric Loader ç‰ˆæœ¬
        import urllib.request
        import json as json_lib
        
        try:
            with urllib.request.urlopen('https://meta.fabricmc.net/v2/versions/loader') as response:
                loader_data = json_lib.loads(response.read())
                latest_loader = loader_data[0]['version']  # ç¬¬ä¸€å€‹æ˜¯æœ€æ–°çš„ç©©å®šç‰ˆ
                print(f"ğŸ“¦ æœ€æ–° Fabric Loader ç‰ˆæœ¬: {latest_loader}")
        except Exception as e:
            print(f"âš ï¸ ç„¡æ³•ç²å–æœ€æ–° Loader ç‰ˆæœ¬ï¼Œä½¿ç”¨é è¨­å€¼: {e}")
            latest_loader = "0.16.9"  # å‚™ç”¨ç‰ˆæœ¬
        
        with open(os.environ['GITHUB_ENV'], 'a') as env_file:
            env_file.write(f"MC_VERSION={latest_version}\n")
            env_file.write(f"FABRIC_API_VERSION={data['fabric_api']}\n")
            env_file.write(f"LOADER_VERSION={latest_loader}\n")
            env_file.write(f"ARTIFACT_PATTERN=chococars-inventory-bridge-fabric-{latest_version}-*\n")
        EOF
        
    - name: Download latest Fabric artifact
      uses: actions/download-artifact@v4
      with:
        pattern: ${{ env.ARTIFACT_PATTERN }}
        path: test-server/
        merge-multiple: true
        
    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        
    - name: Setup Minecraft Fabric Server
      run: |
        mkdir -p test-server
        cd test-server
        
        # ä¸‹è¼‰ Minecraft server jar
        echo "ğŸ“¥ ä¸‹è¼‰ Minecraft $MC_VERSION server..."
        wget -O server.jar "https://piston-data.mojang.com/v1/objects/$(curl -s https://piston-meta.mojang.com/mc/game/version_manifest_v2.json | jq -r ".versions[] | select(.id==\"$MC_VERSION\") | .url" | xargs curl -s | jq -r '.downloads.server.url' | sed 's|.*objects/\([^/]*\)/.*|\1|')/server.jar" || {
          echo "âŒ ç„¡æ³•ä¸‹è¼‰ Minecraft server"
          exit 1
        }
        
        # ä¸‹è¼‰ Fabric installer
        echo "ğŸ“¥ ä¸‹è¼‰ Fabric installer..."
        wget -O fabric-installer.jar "https://maven.fabricmc.net/net/fabricmc/fabric-installer/1.0.1/fabric-installer-1.0.1.jar"
        
        # å®‰è£ Fabric server
        echo "ğŸ”§ å®‰è£ Fabric server..."
        java -jar fabric-installer.jar server -mcversion $MC_VERSION -loader $LOADER_VERSION -downloadMinecraft
        
        # æª¢æŸ¥ç”Ÿæˆçš„ server jar æ–‡ä»¶å
        echo "ğŸ“‹ æª¢æŸ¥ç”Ÿæˆçš„æ–‡ä»¶..."
        ls -la *.jar || true
        
        # æ‰¾åˆ°æ­£ç¢ºçš„ server jar æ–‡ä»¶
        SERVER_JAR=$(find . -name "fabric-server-*.jar" | head -n 1)
        if [ -z "$SERVER_JAR" ]; then
          echo "âŒ æ‰¾ä¸åˆ° Fabric server jar æ–‡ä»¶"
          exit 1
        fi
        echo "âœ… æ‰¾åˆ° server jar: $SERVER_JAR"
        echo "SERVER_JAR_NAME=$(basename $SERVER_JAR)" >> $GITHUB_ENV
        
        # å‰µå»º mods ç›®éŒ„ä¸¦è¤‡è£½æˆ‘å€‘çš„æ¨¡çµ„
        mkdir -p mods
        
        # ä¸‹è¼‰ Fabric API
        echo "ğŸ“¥ ä¸‹è¼‰ Fabric API $FABRIC_API_VERSION..."
        
        # æå–ç‰ˆæœ¬è™Ÿ (ä¾‹å¦‚ "0.131.0+1.21.8" -> "0.131.0")
        API_VERSION_ONLY=$(echo "$FABRIC_API_VERSION" | cut -d'+' -f1)
        
        # å˜—è©¦å¤šå€‹å¯èƒ½çš„ä¸‹è¼‰æº
        DOWNLOAD_SUCCESS=false
        
        # æ–¹æ³•1: Maven repository
        MAVEN_URL="https://maven.fabricmc.net/net/fabricmc/fabric-api/fabric-api/$FABRIC_API_VERSION/fabric-api-$FABRIC_API_VERSION.jar"
        echo "ğŸ” å˜—è©¦ Maven: $MAVEN_URL"
        if wget -O "mods/fabric-api-$FABRIC_API_VERSION.jar" "$MAVEN_URL" 2>/dev/null; then
          echo "âœ… å¾ Maven æˆåŠŸä¸‹è¼‰ Fabric API"
          DOWNLOAD_SUCCESS=true
        else
          # æ–¹æ³•2: GitHub releases (ä½¿ç”¨ç‰ˆæœ¬è™Ÿ)
          GITHUB_URL="https://github.com/FabricMC/fabric/releases/download/v$API_VERSION_ONLY/fabric-api-$FABRIC_API_VERSION.jar"
          echo "ğŸ” å˜—è©¦ GitHub: $GITHUB_URL"
          if wget -O "mods/fabric-api-$FABRIC_API_VERSION.jar" "$GITHUB_URL" 2>/dev/null; then
            echo "âœ… å¾ GitHub æˆåŠŸä¸‹è¼‰ Fabric API"
            DOWNLOAD_SUCCESS=true
          fi
        fi
        
        if [ "$DOWNLOAD_SUCCESS" = false ]; then
          echo "âŒ ç„¡æ³•ä¸‹è¼‰ Fabric APIï¼Œæ¸¬è©¦å°‡å¤±æ•—"
          echo "ğŸ” å˜—è©¦çš„ URL:"
          echo "  - $MAVEN_URL"
          echo "  - $GITHUB_URL"
          rm -f "mods/fabric-api-$FABRIC_API_VERSION.jar" 2>/dev/null || true
        fi
        
        # è¤‡è£½æˆ‘å€‘çš„æ¨¡çµ„
        find . -name "*.jar" -path "*/chococars-inventory-bridge-*" -exec cp {} mods/ \;
        
        # å‰µå»ºåŸºæœ¬çš„ server.properties é¿å…å•Ÿå‹•éŒ¯èª¤
        cat > server.properties << EOF
        online-mode=false
        EOF
        
        # æ¥å— EULA
        echo "eula=true" > eula.txt
        
        echo "âœ… ä¼ºæœå™¨è¨­ç½®å®Œæˆ"
        
    - name: Test Minecraft Server
      timeout-minutes: 2
      run: |
        cd test-server
        
        echo "ğŸš€ å•Ÿå‹• Minecraft ä¼ºæœå™¨é€²è¡Œæ¸¬è©¦..."
        echo "â±ï¸ å°‡é‹è¡Œ 60 ç§’å¾Œè‡ªå‹•é—œé–‰"
        
        # åœ¨èƒŒæ™¯å•Ÿå‹•ä¼ºæœå™¨
        java -Xmx2G -Xms1G -jar "$SERVER_JAR_NAME" nogui > server.log 2>&1 &
        SERVER_PID=$!
        
        echo "ğŸ“‹ ä¼ºæœå™¨ PID: $SERVER_PID"
        
        # ç­‰å¾…ä¼ºæœå™¨å•Ÿå‹•
        echo "â³ ç­‰å¾…ä¼ºæœå™¨å•Ÿå‹•..."
        for i in {1..30}; do
          if grep -q "Done" server.log 2>/dev/null; then
            echo "âœ… ä¼ºæœå™¨å•Ÿå‹•æˆåŠŸï¼"
            break
          fi
          if ! kill -0 $SERVER_PID 2>/dev/null; then
            echo "âŒ ä¼ºæœå™¨å•Ÿå‹•å¤±æ•—"
            echo "ğŸ“‹ ä¼ºæœå™¨æ—¥èªŒï¼š"
            cat server.log
            exit 1
          fi
          echo "â³ ç­‰å¾…ä¸­... ($i/30)"
          sleep 2
        done
        
        # æª¢æŸ¥æ˜¯å¦æˆåŠŸå•Ÿå‹•
        if ! grep -q "Done" server.log; then
          echo "âŒ Fabric ä¼ºæœå™¨å•Ÿå‹•è¶…æ™‚æˆ–å¤±æ•—"
          echo "ğŸ“‹ ä¼ºæœå™¨æ—¥èªŒï¼š"
          cat server.log
          
          # æª¢æŸ¥æ˜¯å¦æœ‰ crash report
          echo ""
          echo "ğŸ” æª¢æŸ¥ crash reports..."
          if [ -d "crash-reports" ] && [ "$(ls -A crash-reports 2>/dev/null)" ]; then
            LATEST_CRASH=$(ls -t crash-reports/*.txt 2>/dev/null | head -n 1)
            if [ -f "$LATEST_CRASH" ]; then
              echo "ğŸ’¥ ç™¼ç¾ crash report: $(basename "$LATEST_CRASH")"
              echo "ğŸ“‹ Crash Report æ‘˜è¦ï¼š"
              echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
              
              # æå–é—œéµè³‡è¨Š
              if grep -q "Exception" "$LATEST_CRASH"; then
                echo "ğŸš¨ ç•°å¸¸é¡å‹ï¼š"
                grep -A 5 -B 2 "Exception\|Error" "$LATEST_CRASH" | head -15
                echo ""
              fi
              
              if grep -q "Caused by:" "$LATEST_CRASH"; then
                echo "ğŸ” æ ¹æœ¬åŸå› ï¼š"
                grep -A 3 "Caused by:" "$LATEST_CRASH" | head -8
                echo ""
              fi
              
              if grep -q "at " "$LATEST_CRASH"; then
                echo "ğŸ“ é—œéµå †ç–Šè¿½è¹¤ï¼š"
                grep "at.*chococar\|at.*fabric\|at.*minecraft" "$LATEST_CRASH" | head -5
                echo ""
              fi
              
              echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
              echo "ğŸ“„ å®Œæ•´ crash report æ–‡ä»¶: $LATEST_CRASH"
            else
              echo "âš ï¸ crash-reports ç›®éŒ„å­˜åœ¨ä½†ç„¡æ³•è®€å–æ–‡ä»¶"
            fi
          else
            echo "â„¹ï¸ æœªç™¼ç¾ crash reports"
          fi
          
          kill $SERVER_PID 2>/dev/null || true
          exit 1
        fi
        
        # é‹è¡Œ 60 ç§’ä¸¦é¡¯ç¤ºå³æ™‚æ—¥èªŒ
        echo "ğŸ® ä¼ºæœå™¨æ­£å¸¸é‹è¡Œä¸­ï¼Œå°‡æŒçºŒ 60 ç§’..."
        echo "ğŸ“‹ å³æ™‚ä¼ºæœå™¨æ—¥èªŒï¼š"
        
        # åœ¨èƒŒæ™¯ç›£æ§ä¼ºæœå™¨ç‹€æ…‹
        (
          for i in {1..60}; do
            if ! kill -0 $SERVER_PID 2>/dev/null; then
              echo "âŒ Fabric ä¼ºæœå™¨æ„å¤–åœæ­¢"
              
              # æª¢æŸ¥ crash report
              if [ -d "crash-reports" ] && [ "$(ls -A crash-reports 2>/dev/null)" ]; then
                LATEST_CRASH=$(ls -t crash-reports/*.txt 2>/dev/null | head -n 1)
                if [ -f "$LATEST_CRASH" ]; then
                  echo "ğŸ’¥ ç™¼ç¾ crash report: $(basename "$LATEST_CRASH")"
                  echo "ğŸ” æ ¹æœ¬åŸå› ï¼š"
                  grep -A 3 "Caused by:" "$LATEST_CRASH" | head -5 || echo "ç„¡æ³•æå–åŸå› "
                fi
              fi
              exit 1
            fi
            sleep 1
          done
        ) &
        MONITOR_PID=$!
        
        # é¡¯ç¤ºå³æ™‚æ—¥èªŒï¼Œç›´åˆ°ç›£æ§çµæŸ
        tail -f server.log &
        TAIL_PID=$!
        
        # ç­‰å¾…ç›£æ§å®Œæˆ
        wait $MONITOR_PID
        MONITOR_EXIT_CODE=$?
        
        # åœæ­¢ tail
        kill $TAIL_PID 2>/dev/null || true
        
        if [ $MONITOR_EXIT_CODE -ne 0 ]; then
          echo "âŒ ä¼ºæœå™¨é‹è¡Œå¤±æ•—"
          exit 1
        fi
        
        # å„ªé›…é—œé–‰ä¼ºæœå™¨
        echo "ğŸ›‘ æ­£åœ¨é—œé–‰ Fabric ä¼ºæœå™¨..."
        
        # æª¢æŸ¥ä¼ºæœå™¨æ˜¯å¦é‚„åœ¨é‹è¡Œ
        if kill -0 $SERVER_PID 2>/dev/null; then
          # ç™¼é€ SIGTERM ä¿¡è™Ÿ
          kill -TERM $SERVER_PID 2>/dev/null || true
          
          # ç­‰å¾…æœ€å¤š 10 ç§’è®“ä¼ºæœå™¨å„ªé›…é—œé–‰
          for i in {1..10}; do
            if ! kill -0 $SERVER_PID 2>/dev/null; then
              echo "âœ… ä¼ºæœå™¨å·²å„ªé›…é—œé–‰"
              break
            fi
            sleep 1
          done
          
          # å¦‚æœé‚„åœ¨é‹è¡Œï¼Œå¼·åˆ¶çµ‚æ­¢
          if kill -0 $SERVER_PID 2>/dev/null; then
            echo "âš ï¸ å¼·åˆ¶çµ‚æ­¢ä¼ºæœå™¨"
            kill -KILL $SERVER_PID 2>/dev/null || true
          fi
        fi
        
        # ç­‰å¾…é€²ç¨‹å®Œå…¨çµæŸ
        wait $SERVER_PID 2>/dev/null || true
        
        echo "âœ… æ¸¬è©¦å®Œæˆï¼ä¼ºæœå™¨æˆåŠŸé‹è¡Œ 60 ç§’"
        echo "ğŸ“‹ æª¢æŸ¥æ¨¡çµ„è¼‰å…¥æƒ…æ³..."
        
        if grep -q "chococars_inventory_bridge" server.log; then
          echo "âœ… Chococar's Inventory Bridge æ¨¡çµ„æˆåŠŸè¼‰å…¥"
        else
          echo "âš ï¸ æœªåœ¨æ—¥èªŒä¸­æ‰¾åˆ°æ¨¡çµ„è¼‰å…¥è¨˜éŒ„"
        fi
        
        # é¡¯ç¤ºé—œéµæ—¥èªŒ
        echo "ğŸ“‹ ä¼ºæœå™¨å•Ÿå‹•æ—¥èªŒæ‘˜è¦ï¼š"
        grep -E "(Done|ERROR|WARN|chococars)" server.log | tail -20 || true

  test-paper-server:
    needs: [get-versions, test-units, build-matrix]
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Get latest version and set up environment for Paper
      run: |
        echo "ğŸ“‹ ç²å–æœ€æ–°ç‰ˆæœ¬é€²è¡Œ Paper æ¸¬è©¦..."
        python << 'EOF'
        import json
        import os
        
        with open('data/latest_versions.json', 'r') as f:
            versions_data = json.load(f)
        
        complete_versions = [v for v, data in versions_data.items() if data['status'] == 'complete']
        complete_versions.sort(key=lambda x: [int(i) for i in x.split('.')], reverse=True)
        
        if not complete_versions:
            print("âŒ æ²’æœ‰æ‰¾åˆ°å®Œæ•´çš„ç‰ˆæœ¬")
            exit(1)
            
        latest_version = complete_versions[0]
        data = versions_data[latest_version]
        
        print(f"ğŸ¯ é¸æ“‡æœ€æ–°ç‰ˆæœ¬é€²è¡Œ Paper æ¸¬è©¦: {latest_version}")
        
        with open(os.environ['GITHUB_ENV'], 'a') as env_file:
            env_file.write(f"MC_VERSION={latest_version}\n")
            env_file.write(f"PAPER_VERSION={data['paper']}\n")
            env_file.write(f"ARTIFACT_PATTERN=chococars-inventory-bridge-paper-{latest_version}-*\n")
        EOF
        
    - name: Download latest Paper artifact
      uses: actions/download-artifact@v4
      with:
        pattern: ${{ env.ARTIFACT_PATTERN }}
        path: test-server/
        merge-multiple: true
        
    - name: Set up JDK 21
      uses: actions/setup-java@v4
      with:
        java-version: '21'
        distribution: 'temurin'
        
    - name: Setup Minecraft Paper Server
      run: |
        mkdir -p test-server
        cd test-server
        
        # ä¸‹è¼‰ Paper server jar
        echo "ğŸ“¥ ä¸‹è¼‰ Paper $PAPER_VERSION server..."
        PAPER_BUILD_URL="https://api.papermc.io/v2/projects/paper/versions/$MC_VERSION/builds"
        LATEST_BUILD=$(curl -s "$PAPER_BUILD_URL" | python3 -c 'import sys, json; data = json.load(sys.stdin); print(data["builds"][-1]["build"])' 2>/dev/null || echo "")
        
        if [ -n "$LATEST_BUILD" ]; then
          PAPER_JAR_URL="https://api.papermc.io/v2/projects/paper/versions/$MC_VERSION/builds/$LATEST_BUILD/downloads/paper-$MC_VERSION-$LATEST_BUILD.jar"
          echo "ğŸ“¥ ä¸‹è¼‰ Paper build $LATEST_BUILD..."
          wget -O server.jar "$PAPER_JAR_URL" || {
            echo "âŒ ç„¡æ³•ä¸‹è¼‰ Paper server"
            exit 1
          }
        else
          echo "âŒ ç„¡æ³•ç²å– Paper æ§‹å»ºè³‡è¨Š"
          exit 1
        fi
        
        # å‰µå»º plugins ç›®éŒ„ä¸¦è¤‡è£½æˆ‘å€‘çš„æ’ä»¶
        mkdir -p plugins
        
        # è¤‡è£½æˆ‘å€‘çš„ Paper æ’ä»¶
        find . -name "*.jar" -path "*/chococars-inventory-bridge-paper-*" -exec cp {} plugins/ \;
        
        # å‰µå»ºåŸºæœ¬çš„ server.properties é¿å…å•Ÿå‹•éŒ¯èª¤
        cat > server.properties << EOF
        online-mode=false
        EOF
        
        # æ¥å— EULA
        echo "eula=true" > eula.txt
        
        echo "âœ… Paper ä¼ºæœå™¨è¨­ç½®å®Œæˆ"
        
    - name: Test Paper Server
      timeout-minutes: 2
      run: |
        cd test-server
        
        echo "ğŸš€ å•Ÿå‹• Paper ä¼ºæœå™¨é€²è¡Œæ¸¬è©¦..."
        echo "â±ï¸ å°‡é‹è¡Œ 60 ç§’å¾Œè‡ªå‹•é—œé–‰"
        
        # åœ¨èƒŒæ™¯å•Ÿå‹•ä¼ºæœå™¨
        java -Xmx2G -Xms1G -jar server.jar nogui > server.log 2>&1 &
        SERVER_PID=$!
        
        echo "ğŸ“‹ ä¼ºæœå™¨ PID: $SERVER_PID"
        
        # ç­‰å¾…ä¼ºæœå™¨å•Ÿå‹•
        echo "â³ ç­‰å¾… Paper ä¼ºæœå™¨å•Ÿå‹•..."
        for i in {1..30}; do
          if grep -q "Done" server.log 2>/dev/null; then
            echo "âœ… Paper ä¼ºæœå™¨å•Ÿå‹•æˆåŠŸï¼"
            break
          fi
          if ! kill -0 $SERVER_PID 2>/dev/null; then
            echo "âŒ Paper ä¼ºæœå™¨å•Ÿå‹•å¤±æ•—"
            echo "ğŸ“‹ ä¼ºæœå™¨æ—¥èªŒï¼š"
            cat server.log
            exit 1
          fi
          echo "â³ ç­‰å¾…ä¸­... ($i/30)"
          sleep 2
        done
        
        # æª¢æŸ¥æ˜¯å¦æˆåŠŸå•Ÿå‹•
        if ! grep -q "Done" server.log; then
          echo "âŒ Paper ä¼ºæœå™¨å•Ÿå‹•è¶…æ™‚æˆ–å¤±æ•—"
          echo "ğŸ“‹ ä¼ºæœå™¨æ—¥èªŒï¼š"
          cat server.log
          
          # æª¢æŸ¥æ˜¯å¦æœ‰ crash report
          echo ""
          echo "ğŸ” æª¢æŸ¥ crash reports..."
          if [ -d "crash-reports" ] && [ "$(ls -A crash-reports 2>/dev/null)" ]; then
            LATEST_CRASH=$(ls -t crash-reports/*.txt 2>/dev/null | head -n 1)
            if [ -f "$LATEST_CRASH" ]; then
              echo "ğŸ’¥ ç™¼ç¾ crash report: $(basename "$LATEST_CRASH")"
              echo "ğŸ“‹ Crash Report æ‘˜è¦ï¼š"
              echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
              
              # æå–é—œéµè³‡è¨Š
              if grep -q "Exception" "$LATEST_CRASH"; then
                echo "ğŸš¨ ç•°å¸¸é¡å‹ï¼š"
                grep -A 5 -B 2 "Exception\|Error" "$LATEST_CRASH" | head -15
                echo ""
              fi
              
              if grep -q "Caused by:" "$LATEST_CRASH"; then
                echo "ğŸ” æ ¹æœ¬åŸå› ï¼š"
                grep -A 3 "Caused by:" "$LATEST_CRASH" | head -8
                echo ""
              fi
              
              if grep -q "at " "$LATEST_CRASH"; then
                echo "ğŸ“ é—œéµå †ç–Šè¿½è¹¤ï¼š"
                grep "at.*chococar\|at.*paper\|at.*minecraft\|at.*bukkit" "$LATEST_CRASH" | head -5
                echo ""
              fi
              
              echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
              echo "ğŸ“„ å®Œæ•´ crash report æ–‡ä»¶: $LATEST_CRASH"
            else
              echo "âš ï¸ crash-reports ç›®éŒ„å­˜åœ¨ä½†ç„¡æ³•è®€å–æ–‡ä»¶"
            fi
          else
            echo "â„¹ï¸ æœªç™¼ç¾ crash reports"
          fi
          
          kill $SERVER_PID 2>/dev/null || true
          exit 1
        fi
        
        # é‹è¡Œ 60 ç§’ä¸¦é¡¯ç¤ºå³æ™‚æ—¥èªŒ
        echo "ğŸ® Paper ä¼ºæœå™¨æ­£å¸¸é‹è¡Œä¸­ï¼Œå°‡æŒçºŒ 60 ç§’..."
        echo "ğŸ“‹ å³æ™‚ Paper ä¼ºæœå™¨æ—¥èªŒï¼š"
        
        # åœ¨èƒŒæ™¯ç›£æ§ä¼ºæœå™¨ç‹€æ…‹
        (
          for i in {1..60}; do
            if ! kill -0 $SERVER_PID 2>/dev/null; then
              echo "âŒ Paper ä¼ºæœå™¨æ„å¤–åœæ­¢"
              
              # æª¢æŸ¥ crash report
              if [ -d "crash-reports" ] && [ "$(ls -A crash-reports 2>/dev/null)" ]; then
                LATEST_CRASH=$(ls -t crash-reports/*.txt 2>/dev/null | head -n 1)
                if [ -f "$LATEST_CRASH" ]; then
                  echo "ğŸ’¥ ç™¼ç¾ crash report: $(basename "$LATEST_CRASH")"
                  echo "ğŸ” æ ¹æœ¬åŸå› ï¼š"
                  grep -A 3 "Caused by:" "$LATEST_CRASH" | head -5 || echo "ç„¡æ³•æå–åŸå› "
                fi
              fi
              exit 1
            fi
            sleep 1
          done
        ) &
        MONITOR_PID=$!
        
        # é¡¯ç¤ºå³æ™‚æ—¥èªŒï¼Œç›´åˆ°ç›£æ§çµæŸ
        tail -f server.log &
        TAIL_PID=$!
        
        # ç­‰å¾…ç›£æ§å®Œæˆ
        wait $MONITOR_PID
        MONITOR_EXIT_CODE=$?
        
        # åœæ­¢ tail
        kill $TAIL_PID 2>/dev/null || true
        
        if [ $MONITOR_EXIT_CODE -ne 0 ]; then
          echo "âŒ Paper ä¼ºæœå™¨é‹è¡Œå¤±æ•—"
          exit 1
        fi
        
        # å„ªé›…é—œé–‰ä¼ºæœå™¨
        echo "ğŸ›‘ æ­£åœ¨é—œé–‰ Paper ä¼ºæœå™¨..."
        
        # æª¢æŸ¥ä¼ºæœå™¨æ˜¯å¦é‚„åœ¨é‹è¡Œ
        if kill -0 $SERVER_PID 2>/dev/null; then
          # ç™¼é€ SIGTERM ä¿¡è™Ÿ
          kill -TERM $SERVER_PID 2>/dev/null || true
          
          # ç­‰å¾…æœ€å¤š 10 ç§’è®“ä¼ºæœå™¨å„ªé›…é—œé–‰
          for i in {1..10}; do
            if ! kill -0 $SERVER_PID 2>/dev/null; then
              echo "âœ… Paper ä¼ºæœå™¨å·²å„ªé›…é—œé–‰"
              break
            fi
            sleep 1
          done
          
          # å¦‚æœé‚„åœ¨é‹è¡Œï¼Œå¼·åˆ¶çµ‚æ­¢
          if kill -0 $SERVER_PID 2>/dev/null; then
            echo "âš ï¸ å¼·åˆ¶çµ‚æ­¢ Paper ä¼ºæœå™¨"
            kill -KILL $SERVER_PID 2>/dev/null || true
          fi
        fi
        
        # ç­‰å¾…é€²ç¨‹å®Œå…¨çµæŸ
        wait $SERVER_PID 2>/dev/null || true
        
        echo "âœ… Paper æ¸¬è©¦å®Œæˆï¼ä¼ºæœå™¨æˆåŠŸé‹è¡Œ 60 ç§’"
        echo "ğŸ“‹ æª¢æŸ¥æ’ä»¶è¼‰å…¥æƒ…æ³..."
        
        if grep -q -i "chococar\|inventory.*bridge" server.log; then
          echo "âœ… Chococar's Inventory Bridge æ’ä»¶æˆåŠŸè¼‰å…¥"
        else
          echo "âš ï¸ æœªåœ¨æ—¥èªŒä¸­æ‰¾åˆ°æ’ä»¶è¼‰å…¥è¨˜éŒ„"
        fi
        
        # é¡¯ç¤ºé—œéµæ—¥èªŒ
        echo "ğŸ“‹ Paper ä¼ºæœå™¨å•Ÿå‹•æ—¥èªŒæ‘˜è¦ï¼š"
        grep -E "(Done|ERROR|WARN|chococar)" server.log | tail -20 || true

  create-release:
    needs: [get-versions, test-units, build-matrix]
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/v') || github.event.inputs.release_type == 'release'
    
    steps:
    - name: Download all artifacts
      uses: actions/download-artifact@v4
      with:
        path: artifacts/
        
    - name: Create Release
      uses: softprops/action-gh-release@v1
      if: startsWith(github.ref, 'refs/tags/v')
      with:
        files: artifacts/**/*.jar
        draft: false
        prerelease: false
        generate_release_notes: true
        body: |
          ## Chococar's Inventory Bridge Release
          
          é€™å€‹ç‰ˆæœ¬åŒ…å«å° Minecraft 1.21.4 åˆ° 1.21.8 çš„å®Œæ•´æ”¯æ´ã€‚
          
          ### æ”¯æ´çš„ç‰ˆæœ¬
          - Minecraft 1.21.4, 1.21.5, 1.21.6, 1.21.7, 1.21.8
          - Java 21+
          
          ### å¹³å°æ”¯æ´
          - âœ… Fabric æ¨¡çµ„
          - âœ… Paper æ’ä»¶
          
          ### å®‰è£èªªæ˜
          1. é¸æ“‡å°æ‡‰æ‚¨çš„ Minecraft ç‰ˆæœ¬å’Œå¹³å°çš„ JAR æ–‡ä»¶
          2. å°‡ JAR æ–‡ä»¶æ”¾å…¥å°æ‡‰çš„ `mods/` æˆ– `plugins/` è³‡æ–™å¤¾
          3. é…ç½® MySQL è³‡æ–™åº«é€£æ¥
          4. é‡å•Ÿä¼ºæœå™¨
          
          ### æ–‡ä»¶ä¸‹è¼‰èªªæ˜
          - `*-fabric-*.jar` - Fabric æ¨¡çµ„æ–‡ä»¶
          - `*-paper-*.jar` - Paper æ’ä»¶æ–‡ä»¶
          - æ–‡ä»¶ååŒ…å«å°æ‡‰çš„ Minecraft ç‰ˆæœ¬è™Ÿ
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  cleanup:
    needs: [get-versions, test-units, build-matrix, test-fabric-server, test-paper-server, create-release]
    runs-on: ubuntu-latest
    if: always()
    
    steps:
    - name: Clean up
      run: |
        echo "ğŸ§¹ æ§‹å»ºå®Œæˆï¼Œæ¸…ç†å·¥ä½œç©ºé–“"
        echo "ğŸ“Š æ§‹å»ºæ‘˜è¦ï¼š"
        echo "   - æ”¯æ´ç‰ˆæœ¬: 1.21.4, 1.21.5, 1.21.6, 1.21.7, 1.21.8"
        echo "   - å¹³å°: Fabric + Paper"
        echo "   - ç¸½è¨ˆ JAR æ–‡ä»¶: 10 å€‹"